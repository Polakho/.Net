@model List<Gauniv.WebServer.Data.Game>
@using X.PagedList.Mvc.Core;
@using X.PagedList;
@{
    ViewData["Title"] = "Delete Games";
}

<link href="~/css/gameList.css" rel="stylesheet" type="text/css" />
<script src="~/js/filterToggle.js"></script>

<h1>Choose games to delete</h1>

<div class="game-filter-section">
    <form method="get" asp-action="DeleteGamePage" class="filter-form">
        <div class="search-bar-container">
            <input type="text" name="searchString" class="form-control" placeholder="Search by name..." value="@ViewData["CurrentFilter"]" />
            <button type="button" class="filter-toggle-btn collapsed" id="filterToggle">More Filters</button>
        </div>

        <div class="filter-options" id="filterOptions">
            <div>
                <label>Filter by tags:</label>
                <div class="tag-checkboxes">
                    @foreach (var local_tag in (List<Gauniv.WebServer.Data.Tags>)ViewData["Tags"])
                    {
                        int[] local_selectedTagIds = (int[])ViewData["SelectedTagIds"];
                        var local_isChecked = local_selectedTagIds.Contains(local_tag.Id);
                        
                        <div class="form-check">
                            <input 
                                type="checkbox" 
                                name="tagIds" 
                                value="@local_tag.Id" 
                                id="tag_@local_tag.Id" 
                                class="form-check-input"
                                @(local_isChecked ? "checked" : "")
                            />
                            <label class="form-check-label" for="tag_@local_tag.Id">
                                @local_tag.Name
                            </label>
                        </div>
                    }
                </div>
            </div>

            <div>
                <label>Filter by price range:</label>
                <div class="price-filter">
                    <div class="price-input-group">
                        <label for="minPrice">Min Price (€):</label>
                        <input 
                            type="number" 
                            name="minPrice" 
                            id="minPrice" 
                            class="form-control" 
                            placeholder="0"
                            value="@ViewData["MinPrice"]"
                            step="0.01"
                            min="0"
                        />
                    </div>
                    <div class="price-input-group">
                        <label for="maxPrice">Max Price (€):</label>
                        <input 
                            type="number" 
                            name="maxPrice" 
                            id="maxPrice" 
                            class="form-control" 
                            placeholder="∞"
                            value="@ViewData["MaxPrice"]"
                            step="0.01"
                            min="0"
                        />
                    </div>
                </div>
            </div>
        </div>

        <div class="filter-buttons">
            <button type="submit" class="btn btn-primary">Filter</button>
            <a href="@Url.Action("Index")" class="btn btn-secondary">Reset</a>
        </div>
    </form>
</div>

<div class="games-container">
@foreach (var item in Model) {
    <form asp-action="DeleteGame" asp-route-id="@item.Id" method="post" style="display:inline;">
        <button type="submit" class="game-card-link" style="border:none; background:none; padding:0; cursor:pointer; height:100%; width:100%;">
            <div class="game-card">
                <div class="game-image-placeholder">
                    <img src="@item.ImagePath" alt="@item.Name" class="game-image" height="200" width="200"/>
                </div>
                <div class="game-info">
                    <h3>@item.Name</h3>
                    <p class="game-price">@item.Price €</p>
                </div>
            </div>
        </button>
    </form>
}